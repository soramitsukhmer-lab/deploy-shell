#!/bin/bash
set -eao pipefail
source "/deploy-shell/.sshagentrc"

SSH_KEY_DIR=~/.ssh

DEFAULT_KEY_FORMATS=(
    id_rsa
    id_ecdsa
    id_ecdsa_sk
    id_ed25519
    id_ed25519_sk
    id_xmss
    id_dsa
)

if [ ! -d "${SSH_KEY_DIR}" ]; then
    exit 0
fi

echo "Attempt to add ssh keys to ssh-agent..."
for key_format in "${DEFAULT_KEY_FORMATS[@]}"; do
    key_file="${SSH_KEY_DIR}/${key_format}"
    if [[ -f "${key_file}" ]]; then
        ssh-add -v "${key_file}"
    fi
done
echo ""

exit 0
